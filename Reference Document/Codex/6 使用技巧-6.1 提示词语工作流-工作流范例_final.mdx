---
title: "工作流范例"
description: "了解 Codex 的各种工作流模式，包括代码库解释、Bug 修复、测试编写、原型设计、代码审查等实际应用场景"
tool: "codex"
slug: "workflows"
---

import { AdPlaceholder } from '@/components/AdPlaceholder'
import { Callout } from '@/components/Callout'

# 工作流

Codex 在您将其视为具有显式上下文和清晰的"完成"定义的队友时效果最佳。本页面提供 Codex IDE 扩展、Codex CLI 和 Codex 云的端到端工作流示例。

如果您是 Codex 新手，请先阅读[提示词](https://developers.openai.com/codex/prompting)，然后再回到这里获取具体的配方。

<AdPlaceholder />

## 如何阅读这些示例

每个工作流包括：

- **使用时机**以及哪种 Codex 界面最适合（IDE、CLI 或云）。
- **步骤**以及示例用户提示词。
- **上下文注释**：Codex 自动看到什么 vs 您应该附加什么。
- **验证**：如何检查输出。

<Callout type="note">
IDE 扩展自动将您的打开文件作为上下文。在 CLI 中，您通常需要显式提及路径（或使用 `/mention` 和 `@` 路径自动补全附加文件）。
</Callout>

---

## 解释代码库

当您正在入职、继承服务或试图推理协议、数据模型或请求流时使用此功能。

### IDE 扩展工作流（本地探索最快）

<WorkflowSteps>

1. 打开最相关的文件。
2. 选择您关心的代码（可选但推荐）。
3. 提示 Codex：

    ```
    Explain how the request flows through the selected code.

    Include:
    - a short summary of the responsibilities of each module involved
    - what data is validated and where
    - one or two "gotchas" to watch for when changing this
    ```

</WorkflowSteps>

验证：

- 要求图表或您可以快速验证的清单：

    ```
    Summarize the request flow as a numbered list of steps. Then list the files involved.
    ```

### CLI 工作流（当您想要记录 + shell 命令时很好）

<WorkflowSteps>

1. 启动交互式会话：

    ```bash
    codex
    ```

2. 附加文件（可选）并提示：

    ```
    I need to understand the protocol used by this service. Read @foo.ts @schema.ts and explain the schema and request/response flow. Focus on required vs optional fields and backward compatibility rules.
    ```

</WorkflowSteps>

上下文注释：

- 您可以使用 `@` 在编辑器中插入文件路径，或 `/mention` 附加特定文件。

---

## 修复 Bug

当您有可以本地重现的失败行为时使用此功能。

### CLI 工作流（紧密循环与重现和验证）

<WorkflowSteps>

1. 在仓库根目录启动 Codex：

    ```bash
    codex
    ```

2. 给 Codex 重现步骤，以及您怀疑的文件：

    ```
    Bug: Clicking "Save" on the settings screen sometimes shows "Saved" but doesn't persist the change.

    Repro:
    1) Start the app: npm run dev
    2) Go to /settings
    3) Toggle "Enable alerts"
    4) Click Save
    5) Refresh the page: the toggle resets

    Constraints:
    - Do not change the API shape.
    - Keep the fix minimal and add a regression test if feasible.

    Start by reproducing the bug locally, then propose a patch and run checks.
    ```

</WorkflowSteps>

上下文注释：

- 由您提供：重现步骤和约束（这些比高级描述更重要）。
- 由 Codex 提供：命令输出、发现的调用站点以及它触发的任何堆栈跟踪。

验证：

- Codex 应在修复后重新运行重现步骤。
- 如果您有标准的检查管道，要求它运行它：

    ```
    After the fix, run lint + the smallest relevant test suite. Report the commands and results.
    ```

### IDE 扩展工作流

<WorkflowSteps>

1. 打开您认为错误所在的文件及其最近的调用者。
2. 提示 Codex：

    ```
    Find the bug causing "Saved" to show without persisting changes. After proposing the fix, tell me how to verify it in the UI.
    ```

</WorkflowSteps>

---

## 编写测试

当您想要非常明确地指定您想要测试的范围时使用此功能。

### IDE 扩展工作流（基于选择）

<WorkflowSteps>

1. 打开包含函数的文件。
2. 选择定义函数的行。从命令面板中选择"Add to Codex Thread"以将这些行添加到上下文。
3. 提示 Codex：

    ```
    Write a unit test for this function. Follow conventions used in other tests.
    ```

</WorkflowSteps>

上下文注释：

- 由"Add to Codex Thread"命令提供：选定的行（这是"行号"范围），加上打开的文件。

### CLI 工作流（路径 + 提示词中描述的行范围）

<WorkflowSteps>

1. 启动 Codex：

    ```bash
    codex
    ```

2. 使用函数名提示：

    ```
    Add a test for the invert_list function in @transform.ts. Cover the happy path plus edge cases.
    ```

</WorkflowSteps>

---

## 根据截图原型

当您有设计模型、截图或 UI 引用并且您想要快速的工作原型时使用此功能。

### CLI 工作流（图像 + 提示词）

<WorkflowSteps>

1. 将您的截图保存在本地（例如 `./specs/ui.png`）。
2. 运行 Codex：

    ```bash
    codex
    ```

3. 将图像文件拖入终端以将其附加到提示词。

4. 继续添加约束和结构：

    ```
    Create a new dashboard based on this image.

    Constraints:
    - Use react, vite, and tailwind. Write the code in typescript.
    - Match spacing, typography, and layout as closely as possible.

    Deliverables:
    - A new route/page that renders the UI
    - Any small components needed
    - README.md with instructions to run it locally
    ```

</WorkflowSteps>

上下文注释：

- 图像提供视觉要求，但您仍然需要在文本中指定实现约束（框架、路由、组件样式）。
- 为获得最佳结果，请在文本中包含任何不明显的行为（悬停状态、验证规则、键盘交互）。

验证：

- 要求 Codex 运行开发服务器（如果允许）并告诉您查看原型的位置：

    ```
    Start the dev server and tell me the local URL/route to view the prototype.
    ```

### IDE 工作流（图像 + 现有文件）

<WorkflowSteps>

1. 在 Codex 聊天中附加图像（拖放或粘贴）。
2. 提示 Codex：

    ```
    Create a new settings page. Use the attached screenshot as the target UI.
    Follow design and visual patterns from other files in this project.
    ```

</WorkflowSteps>

---

## 使用实时更新迭代 UI

当您想要紧密的"设计 → 调整 → 刷新 → 调整"循环而 Codex 编辑代码时使用此功能。

### CLI 工作流（运行 Vite，然后使用小提示词迭代）

<WorkflowSteps>

1. 启动 Codex：

    ```bash
    codex
    ```

2. 在单独的终端窗口中启动开发服务器：

    ```bash
    npm run dev
    ```

3. 提示 Codex 进行更改：

    ```
    Propose 2-3 styling improvements for the landing page.
    ```

4. 选择一个方向并使用小而具体的提示词迭代：

    ```
    Go with option 2.

    Change only the header:
    - make the typography more editorial
    - increase whitespace
    - ensure it still looks good on mobile
    ```

5. 用聚焦请求重复：

    ```
    Next iteration: reduce visual noise.
    Keep the layout, but simplify colors and remove any redundant borders.
    ```

</WorkflowSteps>

验证：

- 随着代码更新，在浏览器中"实时"查看更改。
- 提交您喜欢的更改并回滚不喜欢的更改。
- 如果您回滚或修改更改，告诉 Codex，以便它在处理下一个提示词时不会覆盖更改。

---

## 将重构委派给云端

当您想要仔细设计（本地上下文、快速检查），然后将长时间的实现卸载到可以并行运行的云任务时使用此功能。

### 本地规划（IDE）

<WorkflowSteps>

1. 确保您当前的工作已提交或至少暂存，以便您可以干净地比较更改。
2. 要求 Codex 产生重构计划。如果您有 `$plan` 技能可用，显式调用它：

    ```
    $plan

    We need to refactor the auth subsystem to:
    - split responsibilities (token parsing vs session loading vs permissions)
    - reduce circular imports
    - improve testability

    Constraints:
    - No user-visible behavior changes
    - Keep public APIs stable
    - Include a step-by-step migration plan
    ```

3. 审查计划并协商更改：

    ```
    Revise the plan to:
    - specify exactly which files move in each milestone
    - include a rollback strategy
    ```

</WorkflowSteps>

上下文注释：

- 规划在 Codex 可以本地扫描当前代码时效果最好（入口点、模块边界、依赖图提示）。

### 云端委派（IDE → 云端）

<WorkflowSteps>

1. 如果您还没有这样做，请为 Codex 设置[云环境](https://developers.openai.com/codex/cloud/environments)。
2. 单击提示词编辑器下方的云图标并选择您的云环境。
3. 当您输入下一个提示词时，Codex 会在云端创建一个新线程，该线程携带现有线程上下文（包括计划和任何本地源更改）。

    ```
    Implement Milestone 1 from the plan.
    ```

4. 审查云端差异，根据需要迭代。

5. 直接从云端创建 PR，或将更改本地拉取以测试和完成。

6. 迭代计划的附加里程碑。

</WorkflowSteps>

---

## 进行本地代码审查

当您想要在提交或创建 PR 之前获得第二双眼睛时使用此功能。

### CLI 工作流（审查您的工作树）

<WorkflowSteps>

1. 启动 Codex：

    ```bash
    codex
    ```

2. 运行审查命令：

    ```
    /review
    ```

3. 可选：提供明确的重点说明：

    ```
    /review Focus on edge cases and security issues
    ```

</WorkflowSteps>

验证：

- 根据审查反馈应用修复，然后重新运行 `/review` 以确认问题已解决。

---

## 审查 GitHub 拉取请求

当您想要审查反馈而不本地拉取分支时使用此功能。

在使用此功能之前，在您的存储库上启用 Codex **代码审查**。请参阅[代码审查](https://developers.openai.com/codex/integrations/github)。

### GitHub 工作流（评论驱动）

<WorkflowSteps>

1. 在 GitHub 上打开拉取请求。
2. 留下标记 Codex 的评论并明确重点区域：

    ```
    @codex review
    ```

3. 可选：提供更明确的说明。

    ```
    @codex review for security vulnerabilities and security concerns
    ```

</WorkflowSteps>

---

## 更新文档

当您需要准确且清晰的文档更改时使用此功能。

### IDE 或 CLI 工作流（本地编辑 + 本地验证）

<WorkflowSteps>

1. 确定要更改的文档文件并打开它们（IDE）或 `@` 提及它们（IDE 或 CLI）。
2. 用范围和验证要求提示 Codex：

    ```
    Update the "advanced features" documentation to provide authentication troubleshooting guidance. Verify that all links are valid.
    ```

3. 在 Codex 起草更改后，审查文档并根据需要迭代。

</WorkflowSteps>

验证：

- 阅读渲染的页面。

<AdPlaceholder />
