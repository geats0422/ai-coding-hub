---
title: "å¯è§‚æµ‹æ€§ï¼ˆé¥æµ‹ï¼‰"
description: "äº†è§£å¦‚ä½•ä¸º Gemini CLI å¯ç”¨å’Œè®¾ç½® OpenTelemetryï¼ŒåŒ…æ‹¬æ—¥å¿—ã€æŒ‡æ ‡ã€Google Cloud å’Œæœ¬åœ°é¥æµ‹é…ç½®ã€‚"
tool: "gemini-cli"
slug: "observability-telemetry"
locale: "zh"
---

import { AdPlaceholder } from '@/components/AdPlaceholder'
import { Callout } from '@/components/Callout'

# OpenTelemetry çš„å¯è§‚å¯Ÿæ€§

<AdPlaceholder />

äº†è§£å¦‚ä½•ä¸º Gemini CLI å¯ç”¨å’Œè®¾ç½® OpenTelemetryã€‚-[Observability with OpenTelemetry](#observability-with-opentelemetry)
  -[Key benefits](#key-benefits)
  -[OpenTelemetry integration](#opentelemetry-integration)
  -[Configuration](#configuration)
  -[Google Cloud telemetry](#google-cloud-telemetry)
    -[Prerequisites](#prerequisites)
    -[Authenticating with CLI Credentials](#authenticating-with-cli-credentials)
    -[Direct export (recommended)](#direct-export-recommended)
    -[Collector-based export (advanced)](#collector-based-export-advanced)
    -[Monitoring Dashboards](#monitoring-dashboards)
  -[Local telemetry](#local-telemetry)
    -[File-based output (recommended)](#file-based-output-recommended)
    -[Collector-based export (advanced)](#collector-based-export-advanced-1)
  -[Logs and metrics](#logs-and-metrics)
    -[Logs](#logs)
      -[Sessions](#sessions)
      -[Approval Mode](#approval-mode)
      -[Tools](#tools)
      -[Files](#files)
      -[API](#api)
      -[Model routing](#model-routing)
      - [Chat and streaming](#chat-and-streaming)
      -[Resilience](#resilience)
      -[Extensions](#extensions)
      -[Agent runs](#agent-runs)
      -[IDE](#ide)
      -[UI](#ui)
    -[Metrics](#metrics)
      -[Custom](#custom)
        -[Sessions](#sessions-1)
        -[Tools](#tools-1)
        -[API](#api-1)
        -[Token usage](#token-usage)
        -[Files](#files-1)
        -[Chat and streaming](#chat-and-streaming-1)
        -[Model routing](#model-routing-1)
        -[Agent runs](#agent-runs-1)
        -[UI](#ui-1)
        -[Performance](#performance)
      -[GenAI semantic convention](#genai-semantic-convention)
<AdPlaceholder />

## ä¸»è¦ä¼˜ç‚¹

- **ğŸ” ä½¿ç”¨æƒ…å†µåˆ†æ**ï¼šäº†è§£äº¤äº’æ¨¡å¼å’ŒåŠŸèƒ½é‡‡ç”¨æƒ…å†µ
  æ•´ä¸ªå›¢é˜Ÿ
- **âš¡ æ€§èƒ½ç›‘æ§**ï¼šè·Ÿè¸ªå“åº”æ—¶é—´ã€ä»¤ç‰Œæ¶ˆè€—å’Œ
  èµ„æºåˆ©ç”¨
- **ğŸ› å®æ—¶è°ƒè¯•**ï¼šè¯†åˆ«ç“¶é¢ˆã€æ•…éšœå’Œé”™è¯¯æ¨¡å¼
  å½“å®ƒä»¬å‘ç”Ÿæ—¶
- **ğŸ“Š å·¥ä½œæµç¨‹ä¼˜åŒ–**ï¼šåšå‡ºæ˜æ™ºçš„å†³ç­–ä»¥æ”¹è¿›
  é…ç½®å’Œæµç¨‹
- **ğŸ¢ ä¼ä¸šæ²»ç†**ï¼šç›‘æ§è·¨å›¢é˜Ÿçš„ä½¿ç”¨æƒ…å†µï¼Œè·Ÿè¸ªæˆæœ¬ï¼Œç¡®ä¿
  åˆè§„æ€§ï¼Œå¹¶ä¸ç°æœ‰ç›‘æ§åŸºç¡€è®¾æ–½é›†æˆ

## OpenTelemetry é›†æˆ

åŸºäº **[OpenTelemetry]** æ„å»º - ä¾›åº”å•†ä¸­ç«‹çš„è¡Œä¸šæ ‡å‡†
å¯è§‚å¯Ÿæ€§æ¡†æ¶ â€” Gemini CLI çš„å¯è§‚å¯Ÿæ€§ç³»ç»Ÿæä¾›ï¼š- **é€šç”¨å…¼å®¹æ€§**ï¼šå¯¼å‡ºåˆ°ä»»ä½• OpenTelemetry åç«¯ï¼ˆGoogle
  Cloudã€Jaegerã€Prometheusã€Datadog ç­‰ï¼‰
- **æ ‡å‡†åŒ–æ•°æ®**ï¼šä½¿ç”¨ä¸€è‡´çš„æ ¼å¼å’Œæ”¶é›†æ–¹æ³•
  ä½ çš„å·¥å…·é“¾
- **é¢å‘æœªæ¥çš„é›†æˆ**ï¼šä¸ç°æœ‰å’Œæœªæ¥çš„å¯è§‚å¯Ÿæ€§ç›¸è¿æ¥
  åŸºç¡€è®¾æ–½
- **æ— ä¾›åº”å•†é”å®š**ï¼šåœ¨åç«¯ä¹‹é—´åˆ‡æ¢è€Œæ— éœ€æ›´æ”¹æ‚¨çš„
  ä»ªå™¨ä»ªè¡¨

[å¼€æ”¾é¥æµ‹]ï¼šhttps://opentelemetry.io/

## é…ç½®

æ‰€æœ‰é¥æµ‹è¡Œä¸ºå‡é€šè¿‡æ‚¨çš„`.Gemini/settings.json` æ–‡ä»¶æ§åˆ¶ã€‚
ç¯å¢ƒå˜é‡å¯ç”¨äºè¦†ç›–æ–‡ä»¶ä¸­çš„è®¾ç½®ã€‚|è®¾ç½®|ç¯å¢ƒå˜é‡|æè¿° |ä»·å€¼è§‚ |é»˜è®¤|
| -------------- | -------------------------------- | --------------------------------------------------- | ----------------- | ----------------------- |
| `enabled` | `GEMINI_TELEMETRY_ENABLED` |å¯ç”¨æˆ–ç¦ç”¨é¥æµ‹ | `true`/`false`| `false` |
| `target` | `GEMINI_TELEMETRY_TARGET` |å‘ä½•å¤„å‘é€é¥æµ‹æ•°æ® | `"gcp"`/`"local"` | `"local"` |
| `otlpEndpoint` | `GEMINI_TELEMETRY_OTLP_ENDPOINT` | OTLP æ”¶é›†å™¨ç«¯ç‚¹ |ç½‘å€å­—ç¬¦ä¸²| `http://localhost:4317` |
| `otlpProtocol` | `GEMINI_TELEMETRY_OTLP_PROTOCOL` | OTLPä¼ è¾“åè®®| `"grpc"`/`"http"` | `"grpc"` |
| `outfile` | `GEMINI_TELEMETRY_OUTFILE` |å°†é¥æµ‹æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ï¼ˆè¦†ç›–`otlpEndpoint`ï¼‰|æ–‡ä»¶è·¯å¾„ | - |
| `logPrompts` | `GEMINI_TELEMETRY_LOG_PROMPTS` |åœ¨é¥æµ‹æ—¥å¿—ä¸­åŒ…å«æç¤º | `true`/`false`| `true` |
| `useCollector` | `GEMINI_TELEMETRY_USE_COLLECTOR` |ä½¿ç”¨å¤–éƒ¨ OTLP æ”¶é›†å™¨ï¼ˆé«˜çº§ï¼‰| `true`/`false` | `false` |
| `useCliAuth` | `GEMINI_TELEMETRY_USE_CLI_AUTH` |ä½¿ç”¨ CLI å‡­æ®è¿›è¡Œé¥æµ‹ï¼ˆä»…é™ GCP ç›®æ ‡ï¼‰| `true`/`false` | `false` |
<Callout type="note">
å…³äºå¸ƒå°”ç¯å¢ƒå˜é‡çš„æ³¨æ„äº‹é¡¹ï¼šå¯¹äºå¸ƒå°”è®¾ç½®ï¼ˆ`enabled`ï¼Œ
`logPrompts`,`useCollector`)ï¼Œè®¾ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡ä¸º
`true` æˆ– `1` å°†å¯ç”¨è¯¥åŠŸèƒ½ã€‚ä»»ä½•å…¶ä»–å€¼éƒ½ä¼šç¦ç”¨å®ƒã€‚
</Callout>

æœ‰å…³æ‰€æœ‰é…ç½®é€‰é¡¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…
[Configuration guide](/docs/get-started/configuration)ã€‚

## Google Cloud é¥æµ‹

### å…ˆå†³æ¡ä»¶

åœ¨ä½¿ç”¨ä»¥ä¸‹ä»»ä¸€æ–¹æ³•ä¹‹å‰ï¼Œè¯·å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. è®¾ç½®æ‚¨çš„ Google Cloud é¡¹ç›® IDï¼š
   - å¯¹äºæ¥è‡ªæ¨ç†çš„å•ç‹¬é¡¹ç›®ä¸­çš„é¥æµ‹ï¼š
```
bas
h
     export OTLP_GOOGLE_CLOUD_PROJECT="your-telemetry-project-id"
     
```
-
 å¯¹äºä¸æ¨ç†ç›¸åŒçš„é¡¹ç›®ä¸­çš„é¥æµ‹ï¼š
```
bas
h
     export GOOGLE_CLOUD_PROJECT="your-project-id"
     
```
2
. ä½¿ç”¨ Google Cloud è¿›è¡Œèº«ä»½éªŒè¯ï¼š
   - å¦‚æœä½¿ç”¨ç”¨æˆ·å¸æˆ·ï¼š
```
bas
h
     gcloud auth application-default login
     
```
-
 å¦‚æœä½¿ç”¨æœåŠ¡å¸æˆ·ï¼š
```
bas
h
     export GOOGLE_APPLICATION_CREDENTIALS="/path/to/your/service-account.json"
     
```
3
. ç¡®ä¿æ‚¨çš„è´¦æˆ·æˆ–æœåŠ¡è´¦æˆ·å…·æœ‰ä»¥ä¸‹ IAM è§’è‰²ï¼š
   - äº‘è¿½è¸ªä»£ç†
   - ç›‘æ§æŒ‡æ ‡ç¼–å†™å™¨
   - æ—¥å¿—ç¼–å†™å™¨

4. å¯ç”¨æ‰€éœ€çš„ Google Cloud APIï¼ˆå¦‚æœå°šæœªå¯ç”¨ï¼‰ï¼š
```
bas
h
   gcloud services enable \
     cloudtrace.googleapis.com \
     monitoring.googleapis.com \
     logging.googleapis.com \
     --project="$OTLP_GOOGLE_CLOUD_PROJECT"
   
```
### ä½¿ç”¨ CLI å‡­è¯è¿›è¡Œèº«ä»½éªŒè¯

é»˜è®¤æƒ…å†µä¸‹ï¼ŒGoogle Cloud çš„é¥æµ‹æ”¶é›†å™¨ä½¿ç”¨åº”ç”¨ç¨‹åºé»˜è®¤å€¼
å‡­è¯ (ADC)ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥å°†å…¶é…ç½®ä¸ºä½¿ç”¨ç›¸åŒçš„ OAuth
æ‚¨ç”¨äºç™»å½•Gemini CLI çš„å‡­æ®ã€‚è¿™åœ¨ä»¥ä¸‹æ–¹é¢å¾ˆæœ‰ç”¨
æ²¡æœ‰è®¾ç½® ADC çš„ç¯å¢ƒã€‚

è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·å°† `telemetry` è®¾ç½®ä¸­çš„ `useCliAuth` å±æ€§è®¾ç½®ä¸º
`true`ï¼š
```
jso
n
{
  "telemetry": {
    "enabled": true,
    "target": "gcp",
    "useCliAuth": true
  }
}
```
<Callout type="warning">
é‡è¦ï¼š

- æ­¤è®¾ç½®éœ€è¦ä½¿ç”¨**ç›´æ¥å¯¼å‡º**ï¼ˆè¿›ç¨‹å†…å¯¼å‡ºå™¨ï¼‰ã€‚
- å®ƒ**ä¸èƒ½**ä¸`useCollector: true`ä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœåŒæ—¶å¯ç”¨ä¸¤è€…ï¼Œé¥æµ‹
  å°†è¢«ç¦ç”¨å¹¶è®°å½•é”™è¯¯ã€‚
- CLI å°†è‡ªåŠ¨ä½¿ç”¨æ‚¨çš„å‡­æ®é€šè¿‡ Google è¿›è¡Œèº«ä»½éªŒè¯
  Cloud Traceã€æŒ‡æ ‡å’Œæ—¥å¿—è®°å½• APIã€‚
</Callout>

### ç›´æ¥å¯¼å‡ºï¼ˆæ¨èï¼‰

å°†é¥æµ‹æ•°æ®ç›´æ¥å‘é€åˆ° Google Cloud æœåŠ¡ã€‚æ— éœ€æ”¶é›†å™¨ã€‚

1. åœ¨`.Gemini/settings.json`ä¸­å¯ç”¨é¥æµ‹ï¼š
```
jso
n
   {
     "telemetry": {
       "enabled": true,
       "target": "gcp"
     }
   }
   
```
2
. è¿è¡ŒGemini CLI å¹¶å‘é€æç¤ºã€‚
3.æŸ¥çœ‹æ—¥å¿—å’ŒæŒ‡æ ‡ï¼š
   - å‘é€æç¤ºååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ Google Cloud Consoleï¼š
     - æ—¥å¿—ï¼šhttps://console.cloud.google.com/logs/
     - æŒ‡æ ‡ï¼šhttps://console.cloud.google.com/monitoring/metrics-explorer
     - ç—•è¿¹ï¼šhttps://console.cloud.google.com/traces/list

### åŸºäºæ”¶é›†å™¨çš„å¯¼å‡ºï¼ˆé«˜çº§ï¼‰

å¯¹äºè‡ªå®šä¹‰å¤„ç†ã€è¿‡æ»¤æˆ–è·¯ç”±ï¼Œè¯·ä½¿ç”¨ OpenTelemetry æ”¶é›†å™¨
å°†æ•°æ®è½¬å‘åˆ° Google Cloudã€‚

1. é…ç½®æ‚¨çš„`.Gemini/settings.json`ï¼š
```
jso
n
   {
     "telemetry": {
       "enabled": true,
       "target": "gcp",
       "useCollector": true
     }
   }
   
```
2
. è¿è¡Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼š
```
bas
h
   npm run telemetry -- --target=gcp
   
```
è¿™å°†ï¼š
   - å¯åŠ¨è½¬å‘åˆ° Google Cloud çš„æœ¬åœ° OTEL æ”¶é›†å™¨
   - é…ç½®æ‚¨çš„å·¥ä½œç©ºé—´
   - æä¾›åœ¨ Google Cloud Console ä¸­æŸ¥çœ‹è·Ÿè¸ªè®°å½•ã€æŒ‡æ ‡å’Œæ—¥å¿—çš„é“¾æ¥
   - å°†æ”¶é›†å™¨æ—¥å¿—ä¿å­˜åˆ°`~/.Gemini/tmp/<projectHash>/otel/collector-gcp.log`
   - é€€å‡ºæ—¶åœæ­¢æ”¶é›†å™¨ï¼ˆä¾‹å¦‚`Ctrl+C`ï¼‰
3. è¿è¡ŒGemini CLI å¹¶å‘é€æç¤ºã€‚
4.æŸ¥çœ‹æ—¥å¿—å’ŒæŒ‡æ ‡ï¼š
   - å‘é€æç¤ºååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ Google Cloud Consoleï¼š
     - æ—¥å¿—ï¼šhttps://console.cloud.google.com/logs/
     - æŒ‡æ ‡ï¼šhttps://console.cloud.google.com/monitoring/metrics-explorer
     - ç—•è¿¹ï¼šhttps://console.cloud.google.com/traces/list
   - æ‰“å¼€`~/.Gemini/tmp/<projectHash>/otel/collector-gcp.log`æŸ¥çœ‹æœ¬åœ°
     æ”¶é›†å™¨æ—¥å¿—ã€‚

### ç›‘æ§ä»ªè¡¨æ¿Gemini CLI æä¾›é¢„é…ç½®
[Google Cloud Monitoring](https://cloud.google.com/monitoring) ä»ªè¡¨æ¿è‡³
å¯è§†åŒ–æ‚¨çš„é¥æµ‹æ•°æ®ã€‚

è¯¥ä»ªè¡¨æ¿å¯ä»¥åœ¨ **Google Cloud Monitoring ä»ªè¡¨æ¿ä¸‹æ‰¾åˆ°
æ¨¡æ¿**ä¸ºâ€œ**Gemini CLI ç›‘æ§**â€ã€‚

ï¼[Gemini CLI Monitoring Dashboard Overview](/docs/assets/monitoring-dashboard-overview.png)

ï¼[Gemini CLI Monitoring Dashboard Metrics](/docs/assets/monitoring-dashboard-metrics.png)

ï¼[Gemini CLI Monitoring Dashboard Logs](/docs/assets/monitoring-dashboard-logs.png)

è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤åšå®¢æ–‡ç« ï¼š
[Instant insights: Gemini CLI's new pre-configured monitoring dashboards](https://cloud.google.com/blog/topics/developers-practitioners/instant-insights-Gemini-clis-new-pre-configured-monitoring-dashboards/)ã€‚

## æœ¬åœ°é¥æµ‹å¯¹äºæœ¬åœ°å¼€å‘å’Œè°ƒè¯•ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°æ•è·é¥æµ‹æ•°æ®ï¼š

### åŸºäºæ–‡ä»¶çš„è¾“å‡ºï¼ˆæ¨èï¼‰

1. åœ¨`.Gemini/settings.json`ä¸­å¯ç”¨é¥æµ‹ï¼š
```
jso
n
   {
     "telemetry": {
       "enabled": true,
       "target": "local",
       "otlpEndpoint": "",
       "outfile": ".gemini/telemetry.log"
     }
   }
   
```
2
. è¿è¡ŒGemini CLI å¹¶å‘é€æç¤ºã€‚
3. æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶ï¼ˆä¾‹å¦‚`.Gemini/telemetry.log`ï¼‰ä¸­çš„æ—¥å¿—å’ŒæŒ‡æ ‡ã€‚

### åŸºäºæ”¶é›†å™¨çš„å¯¼å‡ºï¼ˆé«˜çº§ï¼‰

1. è¿è¡Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼š
```
bas
h
   npm run telemetry -- --target=local
   
```
è¿™å°†ï¼š
   - ä¸‹è½½å¹¶å¯åŠ¨ Jaeger å’Œ OTEL æ”¶é›†å™¨
   - é…ç½®æ‚¨çš„å·¥ä½œåŒºä»¥è¿›è¡Œæœ¬åœ°é¥æµ‹
   - åœ¨ http://localhost:16686 æä¾› Jaeger UI
   - å°†æ—¥å¿—/æŒ‡æ ‡ä¿å­˜åˆ°`~/.Gemini/tmp/<projectHash>/otel/collector.log`
   - é€€å‡ºæ—¶åœæ­¢æ”¶é›†å™¨ï¼ˆä¾‹å¦‚`Ctrl+C`ï¼‰
2. è¿è¡ŒGemini CLI å¹¶å‘é€æç¤ºã€‚
3. æŸ¥çœ‹ http://localhost:16686 å¤„çš„è·Ÿè¸ªä»¥åŠæ”¶é›†å™¨æ—¥å¿—ä¸­çš„æ—¥å¿—/æŒ‡æ ‡
   æ–‡ä»¶ã€‚

## æ—¥å¿—å’ŒæŒ‡æ ‡

ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†ç”Ÿæˆçš„æ—¥å¿—å’ŒæŒ‡æ ‡çš„ç»“æ„
Gemini CLIã€‚

`session.id`ã€`installation.id` å’Œ`user.email`ï¼ˆä»…å½“
é€šè¿‡ Google å¸æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼‰ä½œä¸ºå…¬å…±å±æ€§åŒ…å«åœ¨æ‰€æœ‰
æ—¥å¿—å’ŒæŒ‡æ ‡ã€‚

### æ—¥å¿—æ—¥å¿—æ˜¯ç‰¹å®šäº‹ä»¶çš„å¸¦æ—¶é—´æˆ³çš„è®°å½•ã€‚è®°å½•ä»¥ä¸‹äº‹ä»¶
å¯¹äºGemini CLIï¼ŒæŒ‰ç±»åˆ«åˆ†ç»„ã€‚

#### ä¼šè®®

æ•è·å¯åŠ¨é…ç½®å’Œç”¨æˆ·æç¤ºæäº¤ã€‚- `gemini_cli.config`ï¼šä½¿ç”¨ CLI é…ç½®å¯åŠ¨æ—¶å‘å‡ºä¸€æ¬¡ã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `embedding_model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `sandbox_enabled`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `core_tools_enabled`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `approval_mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `api_key_enabled`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `vertex_ai_enabled`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `log_user_prompts_enabled`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `file_filtering_respect_git_ignore`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `debug_mode`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `mcp_servers`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `mcp_servers_count` (int)
    - `extensions`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_ids`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_count` (int)
    - `mcp_tools`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `mcp_tools_count`ï¼ˆæ•´æ•°ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `output_format`ï¼ˆâ€œæ–‡æœ¬â€ã€â€œjsonâ€æˆ–â€œstream-jsonâ€ï¼‰- `gemini_cli.user_prompt`ï¼šå½“ç”¨æˆ·æäº¤æç¤ºæ—¶å‘å‡ºã€‚
  - **å±æ€§**ï¼š
    - `prompt_length` (int)
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `prompt`ï¼ˆå­—ç¬¦ä¸²ï¼›å¦‚æœ`telemetry.logPrompts` æ˜¯`false`ï¼Œåˆ™æ’é™¤ï¼‰
    - `auth_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### å®¡æ‰¹æ¨¡å¼

è·Ÿè¸ªæ‰¹å‡†æ¨¡å¼çš„å˜åŒ–å’ŒæŒç»­æ—¶é—´ã€‚

##### ç”Ÿå‘½å‘¨æœŸ

- `approval_mode_switch`ï¼šæ‰¹å‡†æ¨¡å¼å·²æ›´æ”¹ã€‚
  - **å±æ€§**ï¼š
    - `from_mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `to_mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `approval_mode_duration`ï¼šå¤„äºæ‰¹å‡†æ¨¡å¼çš„æŒç»­æ—¶é—´ã€‚
  - **å±æ€§**ï¼š
    - `mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `duration_ms` (int)

##### æ‰§è¡Œ

è¿™äº›äº‹ä»¶è·Ÿè¸ªæ‰¹å‡†æ¨¡å¼ï¼ˆä¾‹å¦‚è®¡åˆ’æ¨¡å¼ï¼‰çš„æ‰§è¡Œæƒ…å†µã€‚- `plan_execution`ï¼šæ‰§è¡Œäº†è®¡åˆ’å¹¶ä¸”ä¼šè¯ä»è®¡åˆ’æ¨¡å¼åˆ‡æ¢
  åˆ°ä¸»åŠ¨æ‰§è¡Œã€‚
  - **å±æ€§**ï¼š
    - `approval_mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### å·¥å…·

æ•è·å·¥å…·æ‰§è¡Œã€è¾“å‡ºæˆªæ–­å’Œç¼–è¾‘è¡Œä¸ºã€‚- `gemini_cli.tool_call`ï¼šä¸ºæ¯ä¸ªå·¥å…·ï¼ˆå‡½æ•°ï¼‰è°ƒç”¨å‘å‡ºã€‚
  - **å±æ€§**ï¼š
    -`function_name`
    -`function_args`
    -`duration_ms`
    - `success`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `decision`ï¼ˆâ€œæ¥å—â€ã€â€œæ‹’ç»â€ã€â€œè‡ªåŠ¨æ¥å—â€æˆ–â€œä¿®æ”¹â€ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `error`ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
    - `error_type`ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `tool_type`ï¼ˆâ€œæœ¬æœºâ€æˆ–â€œmcpâ€ï¼‰
    - `mcp_server_name`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `extension_id`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `content_length`ï¼ˆæ•´æ•°ï¼Œå¦‚æœé€‚ç”¨ï¼‰
    - `metadata`ï¼ˆå¦‚æœé€‚ç”¨ï¼‰- `gemini_cli.tool_output_truncated`ï¼šå·¥å…·è°ƒç”¨çš„è¾“å‡ºè¢«æˆªæ–­ã€‚
  - **å±æ€§**ï¼š
    - `tool_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `original_content_length` (int)
    - `truncated_content_length` (int)
    - `threshold` (int)
    - `lines` (int)
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.edit_strategy`ï¼šç¼–è¾‘æ‰€é€‰ç­–ç•¥ã€‚
  - **å±æ€§**ï¼š
    - `strategy`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.edit_correction`ï¼šç¼–è¾‘æ ¡æ­£ç»“æœã€‚
  - **å±æ€§**ï¼š
    - `correction`ï¼ˆâ€œæˆåŠŸâ€|â€œå¤±è´¥â€ï¼‰-`gen_ai.client.inference.operation.details`ï¼šæœ¬æ¬¡æ´»åŠ¨æä¾›è¯¦ç»†
  æœ‰å…³ GenAI æ“ä½œçš„ä¿¡æ¯ï¼Œä¸ [OpenTelemetry GenAI
  äº‹ä»¶çš„è¯­ä¹‰çº¦å®š]ã€‚
  - **å±æ€§**ï¼š
    - `gen_ai.request.model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `gen_ai.provider.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `gen_ai.operation.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `gen_ai.input.messages`ï¼ˆjson å­—ç¬¦ä¸²ï¼‰
    - `gen_ai.output.messages`ï¼ˆjson å­—ç¬¦ä¸²ï¼‰
    - `gen_ai.response.finish_reasons`ï¼ˆå­—ç¬¦ä¸²æ•°ç»„ï¼‰
    - `gen_ai.usage.input_tokens` (int)
    - `gen_ai.usage.output_tokens` (int)
    - `gen_ai.request.temperature`ï¼ˆæµ®åŠ¨ï¼‰
    - `gen_ai.request.top_p`ï¼ˆæµ®åŠ¨ï¼‰
    - `gen_ai.request.top_k` (int)
    - `gen_ai.request.max_tokens` (int)
    - `gen_ai.system_instructions`ï¼ˆjson å­—ç¬¦ä¸²ï¼‰
    - `server.address`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `server.port` (int)#### æ–‡ä»¶

è·Ÿè¸ªå·¥å…·æ‰§è¡Œçš„æ–‡ä»¶æ“ä½œã€‚

- `gemini_cli.file_operation`ï¼šé’ˆå¯¹æ¯ä¸ªæ–‡ä»¶æ“ä½œå‘å‡ºã€‚
  - **å±æ€§**ï¼š
    - `tool_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `operation`ï¼ˆâ€œåˆ›å»ºâ€|â€œè¯»å–â€|â€œæ›´æ–°â€ï¼‰
    - `lines`ï¼ˆæ•´æ•°ï¼Œå¯é€‰ï¼‰
    - `mimetype`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `extension`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `programming_language`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

#### API

æ•è· Gemini API è¯·æ±‚ã€å“åº”å’Œé”™è¯¯ã€‚

- `gemini_cli.api_request`ï¼šè¯·æ±‚å‘é€åˆ°Gemini APIã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `request_text`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰- `gemini_cli.api_response`ï¼šä»Gemini API æ”¶åˆ°çš„å“åº”ã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `status_code`ï¼ˆæ•´æ•°|å­—ç¬¦ä¸²ï¼‰
    - `duration_ms` (int)
    - `input_token_count` (int)
    - `output_token_count` (int)
    - `cached_content_token_count` (int)
    - `thoughts_token_count` (int)
    - `tool_token_count` (int)
    - `total_token_count` (int)
    - `response_text`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `auth_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `finish_reasons`ï¼ˆå­—ç¬¦ä¸²æ•°ç»„ï¼‰

- `gemini_cli.api_error`ï¼šAPIè¯·æ±‚å¤±è´¥ã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `error`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `error_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `status_code`ï¼ˆæ•´æ•°|å­—ç¬¦ä¸²ï¼‰
    - `duration_ms` (int)
    - `prompt_id` (string)
    - `auth_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰- `gemini_cli.malformed_json_response`ï¼š`generateJson` æ— æ³•å“åº”
  è§£æã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### æ¨¡å‹è·¯ç”±

- `gemini_cli.slash_command`ï¼šæ‰§è¡Œäº†æ–œæ å‘½ä»¤ã€‚
  - **å±æ€§**ï¼š
    - `command`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `subcommand`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `status`ï¼ˆâ€œæˆåŠŸâ€|â€œé”™è¯¯â€ï¼‰

- `gemini_cli.slash_command.model`ï¼šé€šè¿‡æ–œæ å‘½ä»¤é€‰æ‹©æ¨¡å‹ã€‚
  - **å±æ€§**ï¼š
    - `model_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰

-`gemini_cli.model_routing`ï¼šæ¨¡å‹è·¯ç”±å™¨åšå‡ºäº†å†³å®šã€‚
  - **å±æ€§**ï¼š
    - `decision_model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `decision_source`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `routing_latency_ms` (int)
    - `reasoning`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `failed`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `error_message`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

#### èŠå¤©å’Œæµåª’ä½“- `gemini_cli.chat_compression`ï¼šèŠå¤©ä¸Šä¸‹æ–‡è¢«å‹ç¼©ã€‚
  - **å±æ€§**ï¼š
    - `tokens_before` (int)
    -`tokens_after`ï¼ˆæ•´æ•°ï¼‰

- `gemini_cli.chat.invalid_chunk`ï¼šä»æµæ¥æ”¶åˆ°æ— æ•ˆå—ã€‚
  - **å±æ€§**ï¼š
    - `error.message`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.chat.content_retry`ï¼šç”±äºå†…å®¹é”™è¯¯è€Œè§¦å‘é‡è¯•ã€‚
  - **å±æ€§**ï¼š
    - `attempt_number` (int)
    - `error_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `retry_delay_ms` (int)
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.chat.content_retry_failure`ï¼šæ‰€æœ‰å†…å®¹é‡è¯•å¤±è´¥ã€‚
  - **å±æ€§**ï¼š
    - `total_attempts` (int)
    - `final_error_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `total_duration_ms`ï¼ˆæ•´æ•°ï¼Œå¯é€‰ï¼‰
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰- `gemini_cli.conversation_finished`ï¼šå¯¹è¯ä¼šè¯ç»“æŸã€‚
  - **å±æ€§**ï¼š
    - `approvalMode`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    -`turnCount`ï¼ˆæ•´æ•°ï¼‰

- `gemini_cli.next_speaker_check`ï¼šç¡®å®šä¸‹ä¸€ä½å‘è¨€è€…ã€‚
  - **å±æ€§**ï¼š
    - `prompt_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `finish_reason`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `result`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### éŸ§æ€§

è®°å½•æ¨¡å‹å’Œç½‘ç»œæ“ä½œçš„åå¤‡æœºåˆ¶ã€‚

- `gemini_cli.flash_fallback`ï¼šåˆ‡æ¢åˆ°é—ªå­˜å‹å·ä½œä¸ºåå¤‡ã€‚
  - **å±æ€§**ï¼š
    - `auth_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.ripgrep_fallback`ï¼šåˆ‡æ¢åˆ° grep ä½œä¸ºæ–‡ä»¶æœç´¢çš„åå¤‡ã€‚
  - **å±æ€§**ï¼š
    - `error`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.web_fetch_fallback_attempt`ï¼šå°è¯•ç½‘ç»œè·å–å›é€€ã€‚
  - **å±æ€§**ï¼š
    - `reason` ("private_ip" | "primary_failed")

#### æ‰©å±•è·Ÿè¸ªæ‰©å±•ç”Ÿå‘½å‘¨æœŸå’Œè®¾ç½®æ›´æ”¹ã€‚

- `gemini_cli.extension_install`ï¼šå·²å®‰è£…æ‰©å±•ã€‚
  - **å±æ€§**ï¼š
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_version`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_source`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `status`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.extension_uninstall`ï¼šæ‰©å±•å·²å¸è½½ã€‚
  - **å±æ€§**ï¼š
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `status`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.extension_enable`ï¼šæ‰©å±•å·²å¯ç”¨ã€‚
  - **å±æ€§**ï¼š
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `setting_scope`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.extension_disable`ï¼šæ‰©å±•è¢«ç¦ç”¨ã€‚
  - **å±æ€§**ï¼š
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `setting_scope`ï¼ˆå­—ç¬¦ä¸²ï¼‰- `gemini_cli.extension_update`ï¼šæ‰©å±•å·²æ›´æ–°ã€‚
  - **å±æ€§**ï¼š
    - `extension_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_version`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_previous_version`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `extension_source`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `status`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### ä»£ç†è¿è¡Œ

- `gemini_cli.agent.start`ï¼šä»£ç†è¿è¡Œå·²å¼€å§‹ã€‚
  - **å±æ€§**ï¼š
    - `agent_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `agent_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.agent.finish`ï¼šä»£ç†è¿è¡Œå®Œæˆã€‚
  - **å±æ€§**ï¼š
    - `agent_id`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `agent_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `duration_ms` (int)
    - `turn_count` (int)
    - `terminate_reason`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### é›†æˆå¼€å‘ç¯å¢ƒ

æ•è· IDE è¿æ¥å’Œå¯¹è¯ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚

- `gemini_cli.ide_connection`ï¼šIDE é…å¥—è¿æ¥ã€‚
  - **å±æ€§**ï¼š
    - `connection_type`ï¼ˆå­—ç¬¦ä¸²ï¼‰

#### ç”¨æˆ·ç•Œé¢è·Ÿè¸ªç»ˆç«¯æ¸²æŸ“é—®é¢˜å’Œç›¸å…³ä¿¡å·ã€‚

- `kitty_sequence_overflow`ï¼šç»ˆç«¯kittyæ§åˆ¶åºåˆ—æº¢å‡ºã€‚
  - **å±æ€§**ï¼š
    - `sequence_length` (int)
    - `truncated_sequence`ï¼ˆå­—ç¬¦ä¸²ï¼‰

### æŒ‡æ ‡

æŒ‡æ ‡æ˜¯å¯¹ä¸€æ®µæ—¶é—´å†…è¡Œä¸ºçš„æ•°å€¼æµ‹é‡ã€‚

#### è‡ªå®šä¹‰

##### ä¼šè®®

å¯åŠ¨æ—¶å¯¹ CLI ä¼šè¯è¿›è¡Œè®¡æ•°ã€‚

- `gemini_cli.session.count`ï¼ˆè®¡æ•°å™¨ï¼Œæ•´æ•°ï¼‰ï¼šæ¯æ¬¡ CLI å¯åŠ¨æ—¶é€’å¢ä¸€æ¬¡ã€‚

##### Tools

æµ‹é‡å·¥å…·ä½¿ç”¨æƒ…å†µå’Œå»¶è¿Ÿã€‚

- `gemini_cli.tool.call.count` (Counter, Int)ï¼šå¯¹å·¥å…·è°ƒç”¨è¿›è¡Œè®¡æ•°ã€‚
  - **å±æ€§**ï¼š
    -`function_name`
    - `success`ï¼ˆå¸ƒå°”å€¼ï¼‰
    - `decision`ï¼ˆå­—ç¬¦ä¸²ï¼šâ€œæ¥å—â€ã€â€œæ‹’ç»â€ã€â€œä¿®æ”¹â€æˆ–â€œè‡ªåŠ¨æ¥å—â€ï¼Œå¦‚æœ
      é€‚ç”¨ï¼‰
    - `tool_type`ï¼ˆå­—ç¬¦ä¸²ï¼šâ€œmcpâ€æˆ–â€œnativeâ€ï¼Œå¦‚æœé€‚ç”¨ï¼‰- `gemini_cli.tool.call.latency`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šæµ‹é‡å·¥å…·è°ƒç”¨å»¶è¿Ÿã€‚
  - **å±æ€§**ï¼š
    -`function_name`

##### API

è·Ÿè¸ª API è¯·æ±‚é‡å’Œå»¶è¿Ÿã€‚

- `gemini_cli.api.request.count` (Counter, Int)ï¼šç»Ÿè®¡æ‰€æœ‰ API è¯·æ±‚ã€‚
  - **å±æ€§**ï¼š
    -`model`
    -`status_code`
    - `error_type`ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

- `gemini_cli.api.request.latency`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šæµ‹é‡ API è¯·æ±‚å»¶è¿Ÿã€‚
  - **å±æ€§**ï¼š
    -`model`
  - æ³¨æ„ï¼šä¸`gen_ai.client.operation.duration`ï¼ˆGenAI çº¦å®šï¼‰é‡å ã€‚

##### ä»¤ç‰Œä½¿ç”¨

è·Ÿè¸ªæ¨¡å‹å’Œç±»å‹ä½¿ç”¨çš„ä»¤ç‰Œã€‚- `gemini_cli.token.usage` (Counter, Int)ï¼šè®¡ç®—ä½¿ç”¨çš„ä»¤ç‰Œæ•°ã€‚
  - **å±æ€§**ï¼š
    -`model`
    - `type`ï¼ˆâ€œè¾“å…¥â€ã€â€œè¾“å‡ºâ€ã€â€œæ€æƒ³â€ã€â€œç¼“å­˜â€æˆ–â€œå·¥å…·â€ï¼‰
  - æ³¨æ„ï¼šä¸`input`/`output` çš„`gen_ai.client.token.usage` é‡å ã€‚

##### æ–‡ä»¶

è®¡ç®—å…·æœ‰åŸºæœ¬ä¸Šä¸‹æ–‡çš„æ–‡ä»¶æ“ä½œã€‚

- `gemini_cli.file.operation.count` (Counter, Int)ï¼šå¯¹æ–‡ä»¶æ“ä½œè¿›è¡Œè®¡æ•°ã€‚
  - **å±æ€§**ï¼š
    - `operation`ï¼ˆâ€œåˆ›å»ºâ€ã€â€œè¯»å–â€ã€â€œæ›´æ–°â€ï¼‰
    - `lines`ï¼ˆIntï¼Œå¯é€‰ï¼‰
    - `mimetype`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `extension`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰
    - `programming_language`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.lines.changed`ï¼ˆè®¡æ•°å™¨ï¼ŒIntï¼‰ï¼šæ›´æ”¹çš„è¡Œæ•°ï¼ˆæ¥è‡ªæ–‡ä»¶
  å·®å¼‚ï¼‰ã€‚
  - **å±æ€§**ï¼š
    -`function_name`
    - `type`ï¼ˆâ€œæ·»åŠ â€æˆ–â€œåˆ é™¤â€ï¼‰

##### èŠå¤©å’Œç›´æ’­å‹ç¼©ã€æ— æ•ˆå—å’Œé‡è¯•çš„å¼¹æ€§è®¡æ•°å™¨ã€‚

- `gemini_cli.chat_compression` (Counter, Int): ç»Ÿè®¡èŠå¤©å‹ç¼©
  æ“ä½œã€‚
  - **å±æ€§**ï¼š
    - `tokens_before`ï¼ˆå›½é™…ï¼‰
    - `tokens_after`ï¼ˆå›½é™…ï¼‰

- `gemini_cli.chat.invalid_chunk.count` (Counter, Int)ï¼šè®¡æ•°æ— æ•ˆå—
  æ¥è‡ªæºªæµã€‚

- `gemini_cli.chat.content_retry.count` (Counter, Int): Counts retries due to
  å†…å®¹é”™è¯¯ã€‚

- `gemini_cli.chat.content_retry_failure.count` (Counter, Int)ï¼šå¯¹è¯·æ±‚è¿›è¡Œè®¡æ•°
  æ‰€æœ‰å†…å®¹é‡è¯•å‡å¤±è´¥ã€‚

##### æ¨¡å‹è·¯ç”±

è·¯ç”±å»¶è¿Ÿ/å¤±è´¥å’Œæ–œçº¿å‘½ä»¤é€‰æ‹©ã€‚

- `gemini_cli.slash_command.model.call_count` (Counter, Int)ï¼šè®¡æ•°æ¨¡å‹
  é€šè¿‡æ–œæ å‘½ä»¤è¿›è¡Œé€‰æ‹©ã€‚
  - **å±æ€§**ï¼š
    - `slash_command.model.model_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰- `gemini_cli.model_routing.latency`ï¼ˆç›´æ–¹å›¾ï¼Œmsï¼‰ï¼šæ¨¡å‹è·¯ç”±å†³ç­–
  å»¶è¿Ÿã€‚
  - **å±æ€§**ï¼š
    - `routing.decision_model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `routing.decision_source`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.model_routing.failure.count` (Counter, Int)ï¼šå¯¹æ¨¡å‹è·¯ç”±è¿›è¡Œè®¡æ•°
  å¤±è´¥ã€‚
  - **å±æ€§**ï¼š
    - `routing.decision_source`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `routing.error_message`ï¼ˆå­—ç¬¦ä¸²ï¼‰

##### ä»£ç†è¿è¡Œ

åº§å¸­ç”Ÿå‘½å‘¨æœŸæŒ‡æ ‡ï¼šè¿è¡Œæ¬¡æ•°ã€æŒç»­æ—¶é—´å’Œè½®æ¬¡ã€‚

- `gemini_cli.agent.run.count`ï¼ˆè®¡æ•°å™¨ï¼Œæ•´æ•°ï¼‰ï¼šå¯¹ä»£ç†è¿è¡Œè¿›è¡Œè®¡æ•°ã€‚
  - **å±æ€§**ï¼š
    - `agent_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `terminate_reason`ï¼ˆå­—ç¬¦ä¸²ï¼‰

- `gemini_cli.agent.duration`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šä»£ç†è¿è¡ŒæŒç»­æ—¶é—´ã€‚
  - **å±æ€§**ï¼š
    - `agent_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰- `gemini_cli.agent.turns`ï¼ˆç›´æ–¹å›¾ï¼Œè½®æ¬¡ï¼‰ï¼šæ¯ä¸ªä»£ç†è¿è¡Œçš„è½®æ¬¡ã€‚
  - **å±æ€§**ï¼š
    - `agent_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰

##### å®¡æ‰¹æ¨¡å¼

###### æ‰§è¡Œ

è¿™äº›æŒ‡æ ‡è·Ÿè¸ªç‰¹å®šå®¡æ‰¹å·¥ä½œæµç¨‹çš„é‡‡ç”¨å’Œä½¿ç”¨ï¼Œä¾‹å¦‚
ä½œä¸ºè®¡åˆ’æ¨¡å¼ã€‚

- `gemini_cli.plan.execution.count` (Counter, Int): Counts plan executions.
  - **å±æ€§**ï¼š
    - `approval_mode`ï¼ˆå­—ç¬¦ä¸²ï¼‰

##### ç”¨æˆ·ç•Œé¢

UI ç¨³å®šæ€§ä¿¡å·ï¼Œä¾‹å¦‚é—ªçƒæ¬¡æ•°ã€‚

- `gemini_cli.ui.flicker.count` (Counter, Int)ï¼šå¯¹é—ªçƒçš„ UI å¸§è¿›è¡Œè®¡æ•°
  ï¼ˆæ¸²æŸ“å¾—æ¯”ç»ˆç«¯é«˜ï¼‰ã€‚

##### æ€§èƒ½

é’ˆå¯¹å¯åŠ¨ã€CPU/å†…å­˜å’Œé˜¶æ®µè®¡æ—¶çš„å¯é€‰æ€§èƒ½ç›‘æ§ã€‚

- `gemini_cli.startup.duration`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šCLI å„é˜¶æ®µå¯åŠ¨æ—¶é—´ã€‚
  - **å±æ€§**ï¼š
    - `phase`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `details`ï¼ˆåœ°å›¾ï¼Œå¯é€‰ï¼‰- `gemini_cli.memory.usage`ï¼ˆç›´æ–¹å›¾ï¼Œå­—èŠ‚ï¼‰ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µã€‚
  - **å±æ€§**ï¼š
    - `memory_type`ï¼ˆâ€œheap_usedâ€ï¼Œâ€œheap_totalâ€ï¼Œâ€œå¤–éƒ¨â€ï¼Œâ€œrssâ€ï¼‰
    - `component`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.cpu.usage`ï¼ˆç›´æ–¹å›¾ï¼Œç™¾åˆ†æ¯”ï¼‰ï¼šCPU ä½¿ç”¨ç‡ç™¾åˆ†æ¯”ã€‚
  - **å±æ€§**ï¼š
    - `component`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.tool.queue.depth`ï¼ˆç›´æ–¹å›¾ï¼Œè®¡æ•°ï¼‰ï¼šå·¥å…·ä¸­çš„æ•°é‡
  æ‰§è¡Œé˜Ÿåˆ—ã€‚

- `gemini_cli.tool.execution.breakdown`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šæŒ‰é˜¶æ®µçš„å·¥å…·æ—¶é—´ã€‚
  - **å±æ€§**ï¼š
    - `function_name`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `phase`ï¼ˆâ€œéªŒè¯â€ã€â€œå‡†å¤‡â€ã€â€œæ‰§è¡Œâ€ã€â€œç»“æœå¤„ç†â€ï¼‰- `gemini_cli.api.request.breakdown`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯«ç§’ï¼‰ï¼šæŒ‰é˜¶æ®µçš„ API è¯·æ±‚æ—¶é—´ã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `phase` ("request_preparation", "network_latency", "response_processing",
      â€œä»¤ç‰Œå¤„ç†â€ï¼‰

- `gemini_cli.token.efficiency`ï¼ˆç›´æ–¹å›¾ï¼Œæ¯”ç‡ï¼‰ï¼šä»£å¸æ•ˆç‡æŒ‡æ ‡ã€‚
  - **å±æ€§**ï¼š
    - `model`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `metric`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `context`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰

- `gemini_cli.performance.score`ï¼ˆç›´æ–¹å›¾ï¼Œåˆ†æ•°ï¼‰ï¼šç»¼åˆè¡¨ç°
  å¾—åˆ†ã€‚
  - **å±æ€§**ï¼š
    - `category`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `baseline`ï¼ˆæ•°å­—ï¼Œå¯é€‰ï¼‰- `gemini_cli.performance.regression` (Counter, Int)ï¼šå›å½’æ£€æµ‹
  äº‹ä»¶ã€‚
  - **å±æ€§**ï¼š
    - `metric`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `severity`ï¼ˆâ€œä½â€ã€â€œä¸­â€ã€â€œé«˜â€ï¼‰
    - `current_value`ï¼ˆæ•°å­—ï¼‰
    - `baseline_value`ï¼ˆæ•°å­—ï¼‰

- `gemini_cli.performance.regression.percentage_change`ï¼ˆç›´æ–¹å›¾ï¼Œç™¾åˆ†æ¯”ï¼‰ï¼š
  æ£€æµ‹åˆ°å›å½’æ—¶ç›¸å¯¹äºåŸºçº¿çš„å˜åŒ–ç™¾åˆ†æ¯”ã€‚
  - **å±æ€§**ï¼š
    - `metric`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `severity`ï¼ˆâ€œä½â€ã€â€œä¸­â€ã€â€œé«˜â€ï¼‰
    - `current_value`ï¼ˆæ•°å­—ï¼‰
    - `baseline_value`ï¼ˆæ•°å­—ï¼‰

- `gemini_cli.performance.baseline.comparison`ï¼ˆç›´æ–¹å›¾ï¼Œç™¾åˆ†æ¯”ï¼‰ï¼šæ¯”è¾ƒ
  åˆ°åŸºçº¿ã€‚
  - **å±æ€§**ï¼š
    - `metric`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `category`ï¼ˆå­—ç¬¦ä¸²ï¼‰
    - `current_value`ï¼ˆå·ç ï¼‰
    - `baseline_value`ï¼ˆæ•°å­—ï¼‰

#### GenAI è¯­ä¹‰çº¦å®šä»¥ä¸‹æŒ‡æ ‡ç¬¦åˆ [OpenTelemetry GenAI è¯­ä¹‰çº¦å®š]
GenAI åº”ç”¨ç¨‹åºçš„æ ‡å‡†åŒ–å¯è§‚æµ‹æ€§ï¼š- `gen_ai.client.token.usage`ï¼ˆç›´æ–¹å›¾ã€æ ‡è®°ï¼‰ï¼šè¾“å…¥å’Œè¾“å‡ºçš„æ•°é‡
  æ¯æ¬¡æ“ä½œä½¿ç”¨çš„ä»¤ç‰Œã€‚
  - **å±æ€§**ï¼š
    - `gen_ai.operation.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šæ“ä½œç±»å‹ï¼ˆä¾‹å¦‚ï¼Œ
      â€œç”Ÿæˆå†…å®¹â€ï¼Œâ€œèŠå¤©â€ï¼‰
    - `gen_ai.provider.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šGenAI æä¾›ç¨‹åºï¼ˆâ€œgcp.gen_aiâ€æˆ–
      â€œgcp.vertex_aiâ€ï¼‰
    - `gen_ai.token.type`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šä»¤ç‰Œç±»å‹ï¼ˆâ€œè¾“å…¥â€æˆ–â€œè¾“å‡ºâ€ï¼‰
    - `gen_ai.request.model`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šç”¨äºçš„å‹å·åç§°
      è¦æ±‚
    - `gen_ai.response.model`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šç”Ÿæˆçš„æ¨¡å‹åç§°
      å›åº”
    - `server.address`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šGenAI æœåŠ¡å™¨åœ°å€
    - `server.port`ï¼ˆintï¼Œå¯é€‰ï¼‰ï¼šGenAI æœåŠ¡å™¨ç«¯å£- `gen_ai.client.operation.duration`ï¼ˆç›´æ–¹å›¾ï¼Œsï¼‰ï¼šGenAI è¿è¡ŒæŒç»­æ—¶é—´
  ç§’ã€‚
  - **å±æ€§**ï¼š
    - `gen_ai.operation.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šæ“ä½œç±»å‹ï¼ˆä¾‹å¦‚ï¼Œ
      â€œç”Ÿæˆå†…å®¹â€ï¼Œâ€œèŠå¤©â€ï¼‰
    - `gen_ai.provider.name`ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šGenAI æä¾›ç¨‹åºï¼ˆâ€œgcp.gen_aiâ€æˆ–
      â€œgcp.vertex_aiâ€ï¼‰
    - `gen_ai.request.model`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šç”¨äºçš„å‹å·åç§°
      è¦æ±‚
    - `gen_ai.response.model`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šç”Ÿæˆçš„æ¨¡å‹åç§°
      å›åº”
    - `server.address`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šGenAI æœåŠ¡å™¨åœ°å€
    - `server.port`ï¼ˆintï¼Œå¯é€‰ï¼‰ï¼šGenAI æœåŠ¡å™¨ç«¯å£
    - `error.type`ï¼ˆå­—ç¬¦ä¸²ï¼Œå¯é€‰ï¼‰ï¼šæ“ä½œå¤±è´¥æ—¶çš„é”™è¯¯ç±»å‹[OpenTelemetry GenAI è¯­ä¹‰çº¦å®š]ï¼š
  https://github.com/open-telemetry/semantic-conventions/blob/main/docs/gen-ai/gen-ai-metrics.md
[OpenTelemetry GenAI äº‹ä»¶è¯­ä¹‰çº¦å®š]ï¼š
  https://github.com/open-telemetry/semantic-conventions/blob/8b4f210f43136e57c1f6f47292eb6d38e3bf30bb/docs/gen-ai/gen-ai-events.md

<AdPlaceholder />
