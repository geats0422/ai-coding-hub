---
title: CLI 命令
tool: "opencode"
slug: cli-commands
description: OpenCode CLI 选项和命令 - 默认情况下，CLI 在没有任何参数时运行时启动 TUI。
---

import { AdPlaceholder } from '@/components/AdPlaceholder'
import { Callout } from '@/components/Callout'

<AdPlaceholder />

默认情况下，OpenCode CLI 在没有任何参数时运行时启动 TUI。

```bash
opencode
```

但它也接受本文档中记录的命令。这允许你以编程方式与 OpenCode 交互。

```bash
opencode run "解释 JavaScript 中的闭包是如何工作的"
```

## tui

启动 OpenCode 终端用户界面。

```bash
opencode [project]
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --continue | -c | 继续上一次会话 |
| --session | -s | 要继续的会话 ID |
| --fork | | 继续时分支会话（与 --continue 或 --session 一起使用） |
| --prompt | | 要使用的提示 |
| --model | -m | 以 provider/model 形式使用的模型 |
| --agent | | 要使用的代理 |
| --port | | 要监听的端口 |
| --hostname | | 要监听的主机名 |

<AdPlaceholder />

## 命令

OpenCode CLI 还具有以下命令。

## agent

管理 OpenCode 的代理。

```bash
opencode agent [command]
```

## attach

将终端附加到已通过 serve 或 web 命令启动的 OpenCode 后端服务器。

```bash
opencode attach [url]
```

这允许将 TUI 与远程 OpenCode 后端一起使用。例如：

```bash
# 为 Web/移动访问启动后端服务器
opencode web --port 4096 --hostname 0.0.0.0

# 在另一个终端中，将 TUI 附加到运行中的后端
opencode attach http://10.20.30.40:4096
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --dir | | 要在其中启动 TUI 的工作目录 |
| --session | -s | 要继续的会话 ID |

## create

使用自定义配置创建新代理。

```bash
opencode agent create
```

此命令将引导你创建一个具有自定义系统提示和工具配置的新代理。

## list

列出所有可用代理。

```bash
opencode agent list
```

## auth

管理凭据和提供商登录的命令。

```bash
opencode auth [command]
```

## login

OpenCode 由 Models.dev 上的提供商列表提供支持，因此你可以使用 opencode auth login 为任何你想使用的提供商配置 API 密钥。这些存储在 ~/.local/share/opencode/auth.json 中。

```bash
opencode auth login
```

当 OpenCode 启动时，它从凭据文件加载提供商。如果你的环境或项目中的 .env 文件中定义了任何密钥，也会加载它们。

## list

列出所有已身份验证的提供商（存储在凭据文件中）。

```bash
opencode auth list
```

或使用简写版本。

```bash
opencode auth ls
```

## logout

通过从凭据文件中清除提供商来注销提供商。

```bash
opencode auth logout
```

## github

管理 OpenCode 的 GitHub 代理，用于仓库自动化。

```bash
opencode github [command]
```

## install

在你的仓库中安装 GitHub 代理。

```bash
opencode github install
```

这将设置必要的 GitHub Actions 工作流并引导你完成配置过程。了解更多。

## run

运行 GitHub 代理。这通常在 GitHub Actions 中使用。

```bash
opencode github run
```

### 标志

| 标志 | 描述 |
|------|----------|
| --event | GitHub 要为代理运行的模拟事件 |
| --token | GitHub 个人访问令牌 |

## mcp

管理模型上下文协议服务器。

```bash
opencode mcp [command]
```

## add

将 MCP 服务器添加到你的配置中。

```bash
opencode mcp add
```

此命令将引导你添加本地或远程 MCP 服务器。

## list

列出所有配置的 MCP 服务器及其连接状态。

```bash
opencode mcp list
```

或使用简写版本。

```bash
opencode mcp ls
```

## auth

使用 OAuth 支持的 MCP 服务器进行身份验证。

```bash
opencode mcp auth [name]
```

如果你不提供服务器名称，系统会提示你从可用的 OAuth 能力服务器中选择。

你也可以列出 OAuth 能力服务器及其身份验证状态。

```bash
opencode mcp auth list
```

或使用简写版本。

```bash
opencode mcp auth ls
```

## logout

移除 MCP 服务器的 OAuth 凭据。

```bash
opencode mcp logout [name]
```

## debug

调试 MCP 服务器的 OAuth 连接问题。

```bash
opencode mcp debug <name>
```

## models

列出所有配置提供商的可用模型。

```bash
opencode models [provider]
```

此命令显示你的配置提供商中的所有可用模型，格式为 provider/model。

这有助于确定要在配置中使用的确切模型名称。

你可以选择传递提供商 ID 来按该提供商筛选模型。

```bash
opencode models anthropic
```

### 标志

| 标志 | 描述 |
|------|----------|
| --refresh | 从 models.dev 刷新模型缓存 |
| --verbose | 使用更详细的模型输出（包含成本等元数据） |

使用 --refresh 标志来更新缓存的模型列表。当提供商添加了新模型并且你想在 OpenCode 中看到它们时，这很有用。

```bash
opencode models --refresh
```

## run

通过直接传递提示以非交互模式运行 opencode。

```bash
opencode run [message..]
```

这对于脚本、自动化或当你想要无需启动完整 TUI 即可快速回答时很有用。例如：

```bash
opencode run 解释 Go 中的 context 的使用
```

你也可以附加到正在运行的 opencode serve 实例，以避免每次运行时 MCP 服务器冷启动时间：

```bash
# 在一个终端中启动无头服务器
opencode serve

# 在另一个终端中，运行附加到它的命令
opencode run --attach http://localhost:4096 "解释 JavaScript 中的 async/await 是如何工作的"
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --command | | 要运行的命令，对参数使用 message |
| --continue | -c | 继续上一次会话 |
| --session | -s | 要继续的会话 ID |
| --fork | | 继续时分支会话（与 --continue 或 --session 一起使用） |
| --share | | 分享会话 |
| --model | -m | 以 provider/model 形式使用的模型 |
| --agent | | 要使用的代理 |
| --file | -f | 要附加到消息的文件 |
| --format | | 格式：默认（已格式化）或 json（原始 JSON 事件） |
| --title | | 会话标题（如果未提供值，则使用截断的提示） |
| --attach | | 附加到正在运行的 opencode 服务器（例如，http://localhost:4096） |
| --port | | 本地服务器的端口（默认为随机端口） |

## serve

启动无头 OpenCode 服务器以进行 API 访问。查看服务器文档以获取完整的 HTTP 接口。

```bash
opencode serve
```

这将启动一个提供 API 访问 opencode 功能的 HTTP 服务器，而无需 TUI 界面。设置 OPENCODE_SERVER_PASSWORD 以启用 HTTP 基本身份验证（用户名默认为 opencode）。

### 标志

| 标志 | 描述 |
|------|----------|
| --port | 要监听的端口 |
| --hostname | 要监听的主机名 |
| --mdns | 启用 mDNS 服务发现 |
| --cors | 允许 CORS 的其他浏览器来源 |

## session

管理 OpenCode 会话。

```bash
opencode session [command]
```

## list

列出所有 OpenCode 会话。

```bash
opencode session list
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --max-count | -n | 限制为最近 N 个会话 |
| --format | | 输出格式：table 或 json（table） |

## stats

显示你的 OpenCode 会话的令牌使用和成本统计信息。

```bash
opencode stats
```

### 标志

| 标志 | 描述 |
|------|----------|
| --days | 显示最近 N 天的统计信息（所有时间） |
| --tools | 要显示的工具数量（所有） |
| --models | 显示模型使用细分（默认隐藏）。传递一个数字以显示前 N 个 |
| --project | 按项目筛选（所有项目，空字符串：当前项目） |

## export

将会话数据导出为 JSON。

```bash
opencode export [sessionID]
```

如果你不提供会话 ID，系统将提示你从可用会话中选择。

## import

从 JSON 文件或 OpenCode 分享 URL 导入会话数据。

```bash
opencode import <file>
```

你可以从本地文件或 OpenCode 分享 URL 导入。

```bash
opencode import session.json
opencode import https://opncd.ai/s/abc123
```

## web

启动具有 Web 界面的无头 OpenCode 服务器。

```bash
opencode web
```

这将启动一个 HTTP 服务器并打开一个 Web 浏览器以通过 Web 界面访问 OpenCode。设置 OPENCODE_SERVER_PASSWORD 以启用 HTTP 基本身份验证（用户名默认为 opencode）。

### 标志

| 标志 | 描述 |
|------|----------|
| --port | 要监听的端口 |
| --hostname | 要监听的主机名 |
| --mdns | 启用 mDNS 服务发现 |
| --cors | 允许 CORS 的其他浏览器来源 |

## acp

启动 ACP（代理客户端协议）服务器。

```bash
opencode acp
```

此命令通过 stdin/stdout 使用 nd-JSON 进行通信的 ACP 服务器。

### 标志

| 标志 | 描述 |
|------|----------|
| --cwd | 工作目录 |
| --port | 要监听的端口 |
| --hostname | 要监听的主机名 |

## uninstall

卸载 OpenCode 并删除所有相关文件。

```bash
opencode uninstall
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --keep-config | -c | 保留配置文件 |
| --keep-data | -d | 保留会话数据和快照 |
| --dry-run | | 显示将删除的内容而不实际删除 |
| --force | -f | 跳过确认提示 |

## upgrade

将 opencode 升级到最新版本或特定版本。

```bash
opencode upgrade [target]
```

要升级到最新版本。

```bash
opencode upgrade
```

要升级到特定版本。

```bash
opencode upgrade v0.1.48
```

### 标志

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --method | -m | 使用的安装方法；curl、npm、pnpm、bun、brew |

## 全局标志

opencode CLI 接受以下全局标志。

| 标志 | 简写 | 描述 |
|------|-------|----------|
| --help | -h | 显示帮助 |
| --version | -v | 打印版本号 |
| --print-logs | | 将日志打印到 stderr |
| --log-level | | 日志级别（DEBUG、INFO、WARN、ERROR） |

## 环境变量

可以使用环境变量配置 OpenCode。

| 变量 | 类型 | 描述 |
|----------|------|----------|
| OPENCODE_AUTO_SHARE | boolean | 自动分享会话 |
| OPENCODE_GIT_BASH_PATH | string | Windows 上 Git Bash 可执行文件的路径 |
| OPENCODE_CONFIG | string | 配置文件路径 |
| OPENCODE_CONFIG_DIR | string | 配置目录路径 |
| OPENCODE_CONFIG_CONTENT | string | 内联 json 配置内容 |
| OPENCODE_DISABLE_AUTOUPDATE | boolean | 禁用自动更新检查 |
| OPENCODE_DISABLE_PRUNE | boolean | 禁用旧数据修剪 |
| OPENCODE_DISABLE_TERMINAL_TITLE | boolean | 禁用自动终端标题更新 |
| OPENCODE_PERMISSION | string | 内联 json 权限配置 |
| OPENCODE_DISABLE_DEFAULT_PLUGINS | boolean | 禁用默认插件 |
| OPENCODE_DISABLE_LSP_DOWNLOAD | boolean | 禁用自动 LSP 服务器下载 |
| OPENCODE_ENABLE_EXPERIMENTAL_MODELS | boolean | 启用实验性模型 |
| OPENCODE_DISABLE_AUTOCOMPACT | boolean | 禁用自动上下文压缩 |
| OPENCODE_DISABLE_CLAUDE_CODE | boolean | 禁用从 .claude（提示 + 技能）读取 |
| OPENCODE_DISABLE_CLAUDE_CODE_PROMPT | boolean | 禁用读取 ~/.claude/CLAUDE.md |
| OPENCODE_DISABLE_CLAUDE_CODE_SKILLS | boolean | 禁用加载 .claude/skills |
| OPENCODE_DISABLE_MODELS_FETCH | boolean | 禁用从远程源获取模型 |
| OPENCODE_FAKE_VCS | string | 用于测试目的的假 VCS 提供商 |
| OPENCODE_DISABLE_FILETIME_CHECK | boolean | 禁用文件时间检查以进行优化 |
| OPENCODE_CLIENT | string | 客户端标识符（默认为 cli） |
| OPENCODE_ENABLE_EXA | boolean | 启用 Exa Web 搜索工具 |
| OPENCODE_SERVER_PASSWORD | string | 为 serve/web 启用基本身份验证 |
| OPENCODE_SERVER_USERNAME | string | 覆盖基本身份验证用户名（默认为 opencode） |
| OPENCODE_MODELS_URL | string | 获取模型配置的自定义 URL |

## 实验性

这些环境变量启用了可能更改或移除的实验性功能。

| 变量 | 类型 | 描述 |
|----------|------|----------|
| OPENCODE_EXPERIMENTAL | boolean | 启用所有实验性功能 |
| OPENCODE_EXPERIMENTAL_ICON_DISCOVERY | boolean | 启用图标发现 |
| OPENCODE_EXPERIMENTAL_DISABLE_COPY_ON_SELECT | boolean | 禁用 TUI 中的选择时复制 |
| OPENCODE_EXPERIMENTAL_BASH_DEFAULT_TIMEOUT_MS | number | Bash 命令的默认超时（毫秒） |
| OPENCODE_EXPERIMENTAL_OUTPUT_TOKEN_MAX | number | LLM 响应的最大输出令牌 |
| OPENCODE_EXPERIMENTAL_FILEWATCHER | boolean | 为整个目录启用文件监视器 |
| OPENCODE_EXPERIMENTAL_OXFMT | boolean | 启用 oxfmt 格式化器 |
| OPENCODE_EXPERIMENTAL_LSP_TOOL | boolean | 启用实验性 LSP 工具 |
| OPENCODE_EXPERIMENTAL_DISABLE_FILEWATCHER | boolean | 禁用文件监视器 |
| OPENCODE_EXPERIMENTAL_EXA | boolean | 启用实验性 Exa 功能 |
| OPENCODE_EXPERIMENTAL_LSP_TY | boolean | 启用实验性 LSP 类型检查 |
| OPENCODE_EXPERIMENTAL_MARKDOWN | boolean | 启用实验性 Markdown 功能 |
| OPENCODE_EXPERIMENTAL_PLAN_MODE | boolean | 启用计划模式

<AdPlaceholder />
